<script>
    // failure handler for async server calls, adds dismissable error alert to top of page
    function onFailure(error) {
        var  html = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <strong>Error!</strong> ` + error.message + `
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>`;
        $(".error-box").html(html);
    }
    
    var runner = google.script.run.withFailureHandler(onFailure);

    // load page elements
    $(window).on("pageshow", function() {
      $("#home-content").load("ner_pm_home.html");
    });

    // once page loaded
    $(window).on("load", function () {
      $("#home-content").load("ner_pm_home.html");
      $(".loader-wrapper").fadeOut("slow");
    });

    // update button
    function updateButton(result, button) {
      button.value = 'Result: ' + result;
    }

    // click Go button on Gantt page
    $("#gantt-go-btn").on("click", function () {
        runner.testFunc();
        //var wbs_input = $("#gantt-go-input").val();
        //alert("Gantt go button clicked, WBS # " + wbs_input);
    });

    // click Go button on WP Lookup page
    $("#wp-go-btn").on("click", function () {
        var wp_input = $("#wp-go-input").val();
        alert("WP Lookup go button clicked, WBS # " + wp_input);
    });

    // click Go button on Changes page for change type
    $("#change-type-go-btn").on("click", function () {
        var change_type = $("#change-type-go-input").val();
        alert("Change type go button clicked, type: " + change_type);
    });

    // click Go button on Reports page
    $("#report-type-go-btn").on("click", function () {
        var report_type = $("#report-type-go-input").val();
        alert("Report type go button clicked, type: " + report_type);
    });
  </script>